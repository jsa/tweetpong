<html>
	<head>
		<title>Tweets as PNG | Tweetpong</title>
		<style type="text/css">
		form { margin: 50px 0 40px 0; }
		p { max-width: 600px; }
		span.status { display: block; height: 20px; }
		</style>
	</head>
	<body>
		<form action="#">
			<p>
				<span class="status"></span>
			</p>
			<p>
				<strong>Enter tweet url:</strong>
				<input type="text" size="60" />
				<input type="submit" value="Png"></input>
				<br />
				<input type="radio" name="width" id="w0" value="" checked="checked" />
				<label for="w0">full</label> |
				<input type="radio" name="width" id="w600" value="600" />
				<label for="w600">600px</label> |
				<input type="radio" name="width" id="w500" value="500" />
				<label for="w500">500px</label> |
				<input type="radio" name="width" id="w400" value="400" />
				<label for="w400">400px</label> |
				<input type="radio" name="width" id="w300" value="300" />
				<label for="w300">300px</label>
			</p>
		</form>
		<p>
			<input type="button" value="Random" />
		</p>
		<p>Grab link: <a href="/23019320509.png" class="pong">http://tweetpong.appspot.com/23019320509.png</a></p>
		<p>
			<a href="http://twitter.com/turbofunctor/statuses/23019320509">
				<img src="http://tweetpong.appspot.com/23019320509.png" class="pong">
			</a>
		</p>
		<hr>
		<p>
			For feedback, bugs etc. <a href="http://twitter.com/turbofunctor">tweet me</a>.
			You may use this service freely for embedding tweets everywhere where you can't or
			don't want to use <a href="http://media.twitter.com/blackbird-pie/">Blackbird Pie</a>.
			The service is running on <a href="http://code.google.com/appengine/">AppEngine</a>
			so it can handle quite a lot of traffic.
		</p>
		<p>
			Here's a bookmarklet <a href="javascript:var l=document.location;if(/^http:\/\/twitter.com\/[^\/]+\/status(es)?\/\d+$/.exec(l)){document.location='http://tweetpong.appspot.com/?t='+l}else{alert('Not on a tweet page');}">Tweetpong</a>
			for easy png'ing. Drag it to your bookmarks bar and click on a tweet page,
			it takes you here.
		</p>
		<p>
			API is very simple:
			<br />
			<code>http://tweetpong.appspot.com/&lt;tweet id&gt;.png</code>
			<br />or, with custom width<br />
			<code>http://tweetpong.appspot.com/&lt;tweet id&gt;-&lt;width&gt;.png</code>
			<br />
			HTTP response <code>200</code> if ok, <code>304</code> or <code>500</code> on error.
		</p>
		<a href="http://github.com/jsa/tweetpong"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub" /></a>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
		<script type="text/javascript">
		var form = $('form'),
		    host = window.location.host;
		form.submit(function() {
			var status = $('span.status').empty(),
				twitterUrl = $('[type=text]').val();
			var match = /\/(\d+)$/.exec(twitterUrl);
			if (match) {
				var width = form.find('[name=width]:checked').val(),
				    pngUrl = null;
				if (!width) {
					pngUrl = 'http://' + host + '/' + match[1] + '.png';
				} else {
					pngUrl = 'http://' + host + '/' + match[1] + '-' + width + '.png';
				}
				status.text("Loading...");
				setTimeout(function() { status.empty() }, 1000);
				$('img.pong').attr('src', pngUrl)
				             .parents('a').attr('href', twitterUrl);
				$('a.pong').attr('href', pngUrl)
				           .text(pngUrl);
			} else {
				status.text("Url has to be in format http://twitter.com/turbofunctor/statuses/23019320509");
			}
			return false;
		});
		$('[type=radio]').change(function() { form.submit(); });
		$('[value=Random]').click(function() {
			$.ajax({
				url: '/random/',
				dataType: 'json',
				success: function(tweet) {
					form.find('[type=text]').val('http://twitter.com/' + tweet.user.screen_name
					                             + '/statuses/' + tweet.id);
					form.submit();
				}
			});
		});
		var tweet = /\?t=([^&]+)/.exec(window.location.search);
		if (tweet) {
			$('[type=text]').val(tweet[1]);
			form.submit();
		}
		</script>
	</body>
</html>